--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: 001Test
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _agEnMIilEeWjg81JQYTnGw
Runtime-Version: 2.0.2.201511100828
Save-Time: 1/25/16 11:46 AM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

get-quick-access | set-text setupRCPTT
get-quick-access | key-type Enter


//Open the Dashboard
get-menu "Window/Show View/Other..." | click
with [get-window "Show View"] {
    get-tree | select "Git/Gerrit Dashboard (EGerrit)"
    get-button OK | click
}

//Set-up a Gerrit server from the Dashboard main window
get-view "Gerrit Dashboard (EGerrit)" 
    | get-link "Welcome to the Gerrit dashboard. To get started, please configure a <a>Gerrit Server</a>." | click-link
with [get-window "Gerrit Server Selection"] {
    get-editbox -after [get-label "URL:"] | set-text "http://192.168.50.4:28112/gerrit-2.11.2"
    with [get-editbox -after [get-label "Label:"]] {
        set-text "Vagrant 2.11"
    }
    get-editbox -after [get-label "User:"] | set-text admin
    get-button OK | click
}
with [get-view "Gerrit Dashboard (EGerrit)" ] {
   get-button "Search" | click
}
// Fom the Dashboard, open the ChangeDetailEditor
with [get-view "Gerrit Dashboard (EGerrit)" | get-table] {
    get-cell 1 2 | click
    get-cell 1 2 | mouse down -count 2
    double-click
    get-cell 1 2 | mouse up -count 2
}
//get-editor "./ - Test commit message" | get-group "Conflicts With" | get-table | {
//    get-cell 1 2 | click
//    get-cell 1 2 | mouse down -count 2
//    double-click
//    get-cell 1 2 | mouse up -count 2
//with [get-editor ".* - Test commit message"] {
//    with [get-tab-folder] {
//        get-tab-item Messages | click
//        get-tab-item Files | click
//        get-tab-item History | click
//    }
//    get-table | select "2015 Nov 04 07:17 AM"
//    get-tab-folder | get-tab-item Files | click
//    with [get-table] {
//        get-cell 0 2 | click
//        get-cell 0 2 | mouse down -count 2
//        double-click
//    }
//}
//get-window "EGerrit Tip" | get-button OK | click

//Navigate through the ChangeDetailEditor
with [get-editor ""] {
    with [get-tab-folder] {
        get-tab-item Messages | click
        get-tab-item Files | click
        get-tab-item History | click
    }
    get-table  | click-column -index 0 
    get-table  | get-cell -row 0 -column 1 | click
    }
    
//Select the Sumary tab in the ChangeDetailEditor
//Set the topic field and save it
//Refresh button to update the Dashboard with the topic information
with [get-editor ""] {
    get-tab-folder | get-tab-item Summary | click
    with [get-group General] {
        get-editbox -after [get-label "Topic:"] | set-text "Jacques topic"
        get-button Save | click
    }
}
get-editor "" | get-button Refresh | click



//Test the Abandon button
get-editor "" | get-button Abandon | click
with [get-window "Abandon message"] {
    with [get-editbox] {
        set-text "This review must be abondoned"
    }
get-window "Abandon message" | get-button OK | click
}

//Test the Restore button
get-editor "" | get-button Restore | click
with [get-window "Restore message"] {
    get-editbox -after [get-label "Enter the restore message"] | set-text test
    get-button OK | click
}

//Test the Rebase button
get-editor "" | get-button Rebase | click
with [get-window "Code Review - Rebase Change"] {
    get-editbox -after [get-label "Change parent revision (leave empty to rebase on targeted branch)"] 
        | set-text "test rebase"
    get-button OK | click
    try { get-window "Rebase failed" | get-button OK | click } -catch { wait -ms 1000 } -times 5 -finally {}
    
}

//Test the Check-out button
get-editor "" | get-button Checkout | click
get-window Error | get-button OK | click
get-editor "" | get-button "Cherry-Pick" | click
get-window "Code Review - Cherry Pick Change to Another Branch" | get-button Cancel | click
with [get-editor "" | get-button "Reply..."] {
    click
    get-menu "Reply..." | click
}

//Test the Reply dialogue
with [get-window "Reply dialog"] {
    get-editbox | set-text "Lets reply"
    get-button "Looks good to me, but someone else must approve" | click
    get-button Post | click
}

//START THE CLEANUP 
//Close the Detail Editor
get-editor "" | close

//Remove the definition of the Gerrit Server
get-view "Gerrit Dashboard (EGerrit)" | get-button "Select current Gerrit repository" | click -arrow
get-menu "Add\\/Modify Gerrit Repository..." | click
with [get-window Preferences] {
	get-table  | get-cell -row 0 -column 1
    get-button Remove | click
    get-button OK | click
}

//Close the Dashboard
get-view "Gerrit Dashboard (EGerrit)" | close
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
